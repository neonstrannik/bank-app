{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Redmi/Projects/bank-app%20frontend/src/app/%28auth%29/context/AuthContext.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Cookies from 'js-cookie';\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  firstName: string;\r\n  lastName: string;\r\n}\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  login: (userData: User, token: string) => void;\r\n  logout: () => void;\r\n  isAuthenticated: boolean;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    // Проверяем, есть ли токен при загрузке\r\n    const token = Cookies.get('authToken');\r\n    const userData = Cookies.get('userData');\r\n    \r\n    if (token && userData) {\r\n      try {\r\n        setUser(JSON.parse(userData));\r\n      } catch (error) {\r\n        console.error('Error parsing user data:', error);\r\n        logout();\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const login = (userData: User, token: string) => {\r\n    setUser(userData);\r\n    Cookies.set('authToken', token, { expires: 7 }); // Токен на 7 дней\r\n    Cookies.set('userData', JSON.stringify(userData), { expires: 7 });\r\n    router.push('/dashboard');\r\n  };\r\n\r\n  const logout = () => {\r\n    setUser(null);\r\n    Cookies.remove('authToken');\r\n    Cookies.remove('userData');\r\n    router.push('/');\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{\r\n      user,\r\n      login,\r\n      logout,\r\n      isAuthenticated: !!user\r\n    }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAoBA,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAA+B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAAiC;;IACtE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe;IAC9C,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,wCAAwC;YACxC,MAAM,QAAQ,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC;YAC1B,MAAM,WAAW,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC;YAE7B,IAAI,SAAS,UAAU;gBACrB,IAAI;oBACF,QAAQ,KAAK,KAAK,CAAC;gBACrB,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,4BAA4B;oBAC1C;gBACF;YACF;QACF;iCAAG,EAAE;IAEL,MAAM,QAAQ,CAAC,UAAgB;QAC7B,QAAQ;QACR,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC,aAAa,OAAO;YAAE,SAAS;QAAE,IAAI,kBAAkB;QACnE,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC,YAAY,KAAK,SAAS,CAAC,WAAW;YAAE,SAAS;QAAE;QAC/D,OAAO,IAAI,CAAC;IACd;IAEA,MAAM,SAAS;QACb,QAAQ;QACR,wJAAA,CAAA,UAAO,CAAC,MAAM,CAAC;QACf,wJAAA,CAAA,UAAO,CAAC,MAAM,CAAC;QACf,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAC3B;YACA;YACA;YACA,iBAAiB,CAAC,CAAC;QACrB;kBACG;;;;;;AAGP;GA3CgB;;QAEC,qIAAA,CAAA,YAAS;;;KAFV;AA6CT,SAAS;;IACd,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB","debugId":null}}]
}